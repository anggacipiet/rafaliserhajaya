{{ if site.Params.algolia.enable }}
<div class="search-wrapper">
  <div class="search-box">
    <div id="search-input"></div>
    <div id="search-results"></div>
  </div>
</div>

<!-- Include Algolia scripts -->
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.14.3/dist/algoliasearch-lite.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.49.1/dist/instantsearch.production.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css">

<script>
const searchClient = algoliasearch(
  '{{ site.Params.algolia.app_id }}',
  '{{ site.Params.algolia.search_api_key }}'
);

const search = instantsearch({
  indexName: '{{ site.Params.algolia.index_name }}',
  searchClient,
  searchFunction(helper) {
    const container = document.querySelector('#search-results');
    container.style.display = helper.state.query === '' ? 'none' : '';
    helper.search();
  },
});

// Initialize SearchBox
search.addWidget(
  instantsearch.widgets.searchBox({
    container: '#search-input',
    placeholder: 'Cari produk, artikel...',
    showReset: true,
    showSubmit: true,
    cssClasses: {
      input: 'form-control',
    },
  })
);

// Initialize Hits
search.addWidget(
  instantsearch.widgets.hits({
    container: '#search-results',
    templates: {
      item: function(hit) {
        return `
          <div class="hit-item">
            <a href="${hit.url}">
              <div class="hit-image">
                <img src="${hit.image}" alt="${hit.title}">
              </div>
              <div class="hit-content">
                <h4>${hit.title}</h4>
                <p>${instantsearch.highlight({ attribute: 'description', hit })}</p>
              </div>
            </a>
          </div>
        `;
      },
      empty: function(results) {
        return `
          <div class="no-results">
            Tidak ditemukan hasil untuk "<em>${results.query}</em>"
          </div>
        `;
      }
    },
  })
);

search.start();
</script>

<style>
.search-wrapper {
  position: relative;
  max-width: 600px;
  margin: 0 auto;
}

.search-box {
  position: relative;
}

#search-input {
  margin-bottom: 1rem;
}

#search-results {
  position: absolute;
  width: 100%;
  background: white;
  border-radius: 4px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  z-index: 1000;
  display: none;
}

.hit-item {
  padding: 1rem;
  border-bottom: 1px solid #eee;
}

.hit-item:last-child {
  border-bottom: none;
}

.hit-item a {
  display: flex;
  text-decoration: none;
  color: inherit;
}

.hit-image {
  width: 80px;
  margin-right: 1rem;
}

.hit-image img {
  width: 100%;
  height: auto;
  object-fit: cover;
}

.hit-content h4 {
  margin: 0 0 0.5rem;
  color: #333;
}

.hit-content p {
  margin: 0;
  font-size: 0.9rem;
  color: #666;
}

.no-results {
  padding: 1rem;
  text-align: center;
  color: #666;
}
</style>
{{ end }} 